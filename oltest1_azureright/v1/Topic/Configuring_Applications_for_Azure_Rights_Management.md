---
description: na
keywords: na
title: Configuring Applications for Azure Rights Management
search: na
ms.date: na
ms.service: rights-management
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: ea09cbc5-b98b-444e-8b60-5bc3cb199c36
---
# Azure Rights Management alkalmaz&#225;sok konfigur&#225;l&#225;sa
> [!NOTE]
> Ezt az információt a rendszergazdák és a tanácsadó, akik telepítették Azure Rights Management szolgál. Ha a felhasználó a Súgó és a Rights Management használata egy adott alkalmazáshoz, vagy a védett egy fájl megnyitása kapcsolatos információkat keres, használja a Súgó és az alkalmazás kísérik útmutatások.
> 
> Például az Office-alkalmazásokhoz, kattintson a súgó ikon, és adja meg a keresési feltételeket, például az **Rights Management** vagy **IRM**. Az RMS-megosztó a Windows alkalmazás, tekintse meg a [a Rights Management megosztási alkalmazás felhasználói útmutató](http://technet.microsoft.com/library/dn339006.aspx).

A szervezetben telepített Azure Rights Management (Azure RMS), miután használata a következő adatokat konfigurálásához, alkalmazások és a szolgáltatások támogatja az Azure RMS. Ezek közé tartoznak, például a Word 2013, a Word 2010 és az Office-alkalmazásokhoz, és a szolgáltatásokkal, például az Exchange Online (átviteli szabályok, adatvesztés megelőzése, előre nem do és üzenetek titkosítása) és a SharePoint Online (védett könyvtárak). Hogyan az alkalmazások és a szolgáltatások támogatja a Rights Management kapcsolatos információkért tekintse meg a [Hogyan alkalmazások támogatják a Azure Rights Management](../Topic/How_Applications_Support_Azure_Rights_Management.md).

> [!IMPORTANT]
> Támogatott verzióját, és az egyéb követelmények kapcsolatos információkért tekintse meg a [Az Azure Rights Management követelményei](../Topic/Requirements_for_Azure_Rights_Management.md).

-   [Az Office 365: Az ügyfelek és az online szolgáltatások konfigurációja](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_O365)

    -   [Az Exchange Online: A tartalomvédelmi szolgáltatás konfigurációja](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_ExchangeOnline)

    -   [SharePoint Online és az üzleti OneDrive: A tartalomvédelmi szolgáltatás konfigurációja](#BKMK_SharePointOnline)

-   [Office 2016 és az Office 2013: Ügyfelek konfigurálása](#BKMK_Office2013Configuration)

-   [Az Office 2010: Ügyfelek konfigurálása](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_Office2010Configuration)

-   [A Rights Management megosztóalkalmazás: Telepítés és az ügyfelek konfigurálása](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_SharingApp)

    -   [Az RMS-megosztó a Windows alkalmazás: Telepítés és a konfiguráció](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_SharingAppforWindows)

    -   [Az RMS-megosztó a mobil platformokon alkalmazás: A telepítés](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_SharingAppMovileDevices)

-   [Más alkalmazások, amely támogatja az RMS API-k: Telepítés és a konfiguráció](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_RMSAPIs)

A helyszíni kiszolgálók, például az Exchange Server és a SharePoint-kiszolgáló, lásd: [Az Azure Rights Management összekötő telepítése](../Topic/Deploying_the_Azure_Rights_Management_Connector.md).

> [!TIP]
> Magas szintű példák és az Azure RMS használatához konfigurált alkalmazások képernyőképek, tekintse meg a [A művelet az Azure RMS: A rendszergazdák és felhasználók lásd](../Topic/What_is_Azure_Rights_Management_.md#BKMK_RMSpictures) a szakasz az [Mi az Azure Rights Management?](../Topic/What_is_Azure_Rights_Management_.md) című témakört.

## <a name="BKMK_O365"></a>Az Office 365: Az ügyfelek és az online szolgáltatások konfigurációja
Office 365 az Azure RMS natív módon támogatott, mert nincs ügyfélszámítógép konfigurálása nem szükséges az alkalmazások, például a Word, Excel, PowerPoint, az Outlook és az Outlook Web App támogatására a tartalomvédelmi (szolgáltatás IRM) szolgáltatásokat. Minden felhasználó nem rendelkezik, jelentkezzen be az Office-alkalmazásokhoz, azok [!INCLUDE[o365_1](../Token/o365_1_md.md)] hitelesítő adatokat, és is védheti a fájlokat, és az e-maileket, és használni a fájlok és a mások által védett e-maileket..

Azonban azt javasoljuk, hogy ezek az alkalmazások kiegészítik-e a Rights Management szolgáltatással megosztó alkalmazásban, hogy a felhasználók élvezheti a az Office bővítmény. További tudnivalókért tekintse meg a [A Rights Management megosztóalkalmazás: Telepítés és az ügyfelek konfigurálása](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_SharingApp) szakaszban, a jelen témakörben található.

### <a name="BKMK_ExchangeOnline"></a>Az Exchange Online: A tartalomvédelmi szolgáltatás konfigurációja
Konfigurálja az Exchange Online támogatásához az Azure RMS, konfigurálnia kell a tartalomvédelmi (szolgáltatás IRM) szolgáltatás az Exchange Online. Ehhez használja a Windows PowerShell (telepítése nem szükséges egy külön modul), és futtassa [PowerShell-parancsok az Exchange Online](https://technet.microsoft.com/library/jj200677.aspx).

> [!NOTE]
> Nem lehet jelenleg konfigurálása Exchange Online Azure RMS támogatásához, ha az ügyfél által felügyelt bérlői kulcs (BYOK) az Azure RMS, nem pedig az alapértelmezett konfiguráció, a Microsoft által felügyelt bérlői kulcs használ. További tudnivalókért tekintse meg a [BYOK pricing and restrictions](../Topic/Planning_and_Implementing_Your_Azure_Rights_Management_Tenant_Key.md#BKMK_Pricing) szakasz a [Tervezés és végrehajtási a Azure Rights Management bérlői kulcs](../Topic/Planning_and_Implementing_Your_Azure_Rights_Management_Tenant_Key.md) című témakört.
> 
> Megkísérli az Exchange Online konfigurálása, ha az Azure RMS által használt BYOK, ha a kulcs (az alábbi eljárás 5. lépés) importálása a parancs futása sikertelen, és a hibaüzenet **[FailureCategory = parancsmag-FailedToGetTrustedPublishingDomainFromRmsOnlineException]**.

A következő lépéseket jellemző engedélyezése az Exchange Online Azure RMS használatához volna futó parancsokat tartalmazza:

1.  Ha első alkalommal használt Windows PowerShell az Exchange Online a számítógépen, konfigurálnia kell a Windows PowerShell aláírt parancsfájlok futtatását. Indítsa el a Windows PowerShell-munkamenet segítségével a **Futtatás rendszergazdaként** lehetőséget, és írja be:

    ```
    Set-ExecutionPolicy RemoteSigned
    ```

2.  A Windows PowerShell munkamenetben jelentkezzen be az Exchange Online fiókkal, hogy engedélyezve van-e a távelérés rendszerhéj. Alapértelmezés szerint az Exchange Online létrehozott összes fiókok engedélyezve vannak a távelérés rendszerhéj, de ez is le van tiltva (és engedélyezve) használatával a   [felhasználói fiók beállítása &lt; felhasználói &gt; identitáshoz - RemotePowerShellEnabled](https://technet.microsoft.com/library/jj984292%28v=exchg.160%29.aspx) parancsot.

    Jelentkezzen be, írja be:

    ```
    $Cred = Get-Credential
    ```
    Az a **a Windows PowerShell-hitelesítési kérelem** párbeszédpanel mezőbe adja meg az Office 365-felhasználó nevét és a jelszót.

3.  Kapcsolódás az Exchange Online szolgáltatás a következő két parancsok futtatásával:

    ```
    $Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell/ -Credential $Cred -Authentication Basic –AllowRedirection
    ```

    ```
    Import-PSSession $Session
    ```

4.  Adja meg az Azure RMS bérlői kulcs helyét a régió szerint:

    Észak-Amerika (és kormánya előfizetések):

    ```
    Set-IRMConfiguration -RMSOnlineKeySharingLocation "https://sp-rms.na.aadrm.com/TenantManagement/ServicePartner.svc"
    ```
    Európai:

    ```
    Set-IRMConfiguration -RMSOnlineKeySharingLocation "https://sp-rms.eu.aadrm.com/TenantManagement/ServicePartner.svc"
    ```
    Az ázsiai:

    ```
    Set-IRMConfiguration -RMSOnlineKeySharingLocation "https://sp-rms.ap.aadrm.com/TenantManagement/ServicePartner.svc"
    ```
    A Dél-Amerika:

    ```
    Set-IRMConfiguration -RMSOnlineKeySharingLocation "https://sp-rms.sa.aadrm.com/TenantManagement/ServicePartner.svc"
    ```

5.  Konfigurációs adatok importálása az Azure RMS Exchange Online, a megbízható közzétételi tartomány (TPD) formájában. Ez magába foglalja a az Azure RMS bérlői kulcs és az Azure RMS-sablonok:

    ```
    Import-RMSTrustedPublishingDomain -RMSOnline -name "RMS Online"
    ```
    Ez a parancs régebben neve **RMS Online** az Azure RMS szolgáltatást az Exchange Online a TPD alap nevét. A TPD importálása után névvel **RMS Online - 1** az Exchange Online.

6.  Engedélyezése az Azure RMS-funkció, úgy, hogy a tartalomvédelmi szolgáltatás funkciók érhetők el az Exchange Online:

    ```
    Set-IRMConfiguration -InternalLicensingEnabled $true
    ```
    A parancs futtatása után a Rights Management automatikusan engedélyezve van az Outlook ügyfélprogramot az Outlook Web app, és az Exchange Active Sync szolgáltatással.

7.  Szükség esetén ellenőrizze, hogy ez a konfiguráció sikeres segítségével el a következő parancsot:

    ```
    Test-IRMConfiguration -Sender <user email address>
    ```
    Példa: **Test-IRMConfiguration -Sender  adams@contoso.com**

    Ez a parancs magában foglalja a szolgáltatás kapcsolat ellenőrzése, lekérte a konfigurációt, URI-azonosító, licenceket és bármely sablonok beolvasása ellenőrzések sorozatát futtatja. A Windows PowerShell-munkamenet látják az eredmények az egyes, és a végén, ha minden átment az ellenőrzések rendszeres időközönként mennek: **ÁLTALÁNOS EREDMÉNYE: ÁTHALADÁS**

8.  A távoli PowerShell-munkamenet leválasztása:

    ```
    Remove-PSSession $Session
    ```

Felhasználók most már az e-mailek védelme Azure RMS használatával. Az Outlook Web alkalmazásban válassza ki például **engedélyek beállítása** a kiterjesztett menüből (**...**), és válassza a **nem továbbítandó** vagy az elérhető sablonok az e-mailt az információk védelméről alkalmazandó, és a mellékleteket. Azonban, mert az Outlook Web App gyorsítótárába a felhasználói felület, a nap, várjon, amíg a tétlen az adatok védelme alkalmazása az e-mailek és a konfigurációs parancsok futtatása után próbálja időtartam alatt. Mielőtt a felhasználói felület frissíti az új konfigurációt megfelelően, nem jelenik meg a beállításokat a **engedélyek beállítása** menüből.

> [!IMPORTANT]
> Ha új létrehozása [egyéni sablonok](https://technet.microsoft.com/library/dn642472.aspx) az Azure RMS vagy a frissítés a sablonok, minden alkalommal, futtatnia kell a következő Exchange Online PowerShell-parancsot (ha szükséges, Futtatás lépések 2. és 3 először) Exchange online ezek a változások szinkronizálása: `Import-RMSTrustedPublishingDomain -Name "RMS Online - 1" -RefreshTemplates –RMSOnline`

Exchange-rendszergazdai most konfigurálhatja funkcióit, amelyek az adatok védelme automatikusan alkalmazza, például a [átviteli szabályok](https://technet.microsoft.com/library/dd302432.aspx), [adatvesztés megelőzése (DLP) házirendeket](https://technet.microsoft.com/library/jj150527%28v=exchg.150%29.aspx), és [hangposta védett](https://technet.microsoft.com/library/dn198211%28v=exchg.150%29.aspx) (Unified üzenetkezelési).

Részletes utasításokra van szüksége konfigurálása az Exchange Online Tartalomvédelmi szolgáltatás engedélyezéséhez a dokumentációjában a Exchange könyvtárban. Példa:

-   [Csatlakozni az Exchange Online távoli PowerShell használatával](https://technet.microsoft.com/library/jj984289%28v=exchg.160%29.aspx)

-   [Konfigurálja a tartalomvédelmi szolgáltatás Azure Rights Management használata](https://technet.microsoft.com/library/dn151475%28v=exchg.150%29.aspx)

#### Az Office 365-üzenetek titkosítása
Az előző részben leírtak szerint, de abban az esetben, ha nem szeretné, hogy sablonok jelennek meg, 6. lépés futtassa a következő parancsot, így megakadályozhatja, hogy a tartalomvédelmi szolgáltatás sablonok az Outlook Web App és az Outlook ügyfélprogram a rendelkezésre álló előtt, futtassa a ugyanezeket a lépéseket: `Set-IRMConfiguration -ClientAccessServerEnabled $false`

Ezt követően készen konfigurálása [átviteli szabályok](https://technet.microsoft.com/library/dd302432.aspx) automatikusan módosítani az üzenet biztonsági, ha a címzett kívül a szervezet találhatók, és válassza a **alkalmazása Office 365 üzenet titkosítási** lehetőséget.

Üzenetek titkosítása kapcsolatos további információkért tekintse meg a [az Office 365 rendszerben titkosítási](https://technet.microsoft.com/library/dn569286.aspx) az Exchange-könyvtárban.

### <a name="BKMK_SharePointOnline"></a>SharePoint Online és az üzleti OneDrive: A tartalomvédelmi szolgáltatás konfigurációja
SharePoint Online és konfigurálásához az üzleti OneDrive támogatja az Azure RMS, először engedélyeznie kell a tartalomvédelmi (szolgáltatás IRM) szolgáltatás a SharePoint Online a SharePoint-felügyeleti központ használatával. Ezt követően a webhely tulajdonosainak is az a tartalomvédelmi szolgáltatás védelme, a SharePoint-listák és dokumentumtárak, és a felhasználók a tartalomvédelmi szolgáltatás védelme üzleti Library azok OneDrive, hogy a nem mentett, és másokkal, megosztott dokumentumok automatikusan Azure RMS által védett.

Ahhoz, hogy a tartalomvédelmi (szolgáltatás IRM) szolgáltatás a SharePoint Online, tekintse meg az alábbi utasításokat az Office webhely:

-   [Felfelé információkat Rights Management szolgáltatás (IRM) beállítása a SharePoint-felügyeleti központban](http://office.microsoft.com/office365-sharepoint-online-enterprise-help/set-up-information-rights-management-irm-insharepoint-online-HA102895193.aspx)

Ez a konfiguráció az Office 365 rendszergazdáját végzi.

#### A tartalomvédelmi szolgáltatás könyvtárak és listák konfigurálása
Miután engedélyezte a Tartalomvédelmi szolgáltatás a SharePoint, webhely tulajdonosainak is a tartalomvédelmi szolgáltatás védelme listája, valamint a SharePoint-dokumentumtárak. További tudnivalókért tekintse meg az Office webhely a következő:

-   [A tartalomvédelmi szolgáltatás alkalmazása a lista vagy könyvtár](http://office.microsoft.com/sharepoint-help/apply-information-rights-management-to-a-list-or-library-HA102891460.aspx)

Ez a konfiguráció a SharePoint webhely rendszergazdája végzi.

#### <a name="BKMK_OneDrive"></a>A tartalomvédelmi szolgáltatás üzleti OneDrive konfigurálása
Miután engedélyezte a Tartalomvédelmi szolgáltatás a SharePoint Online, üzleti dokumentumtár felhasználók OneDrive majd beállítható, hogy a Rights Management védelemre.  A felhasználók segítségével állíthatja be ezt a magukat a **Beállítások** azok OneDrive ikonra. Bár a rendszergazdák nem tudja konfigurálni a Rights Management az üzleti felhasználók OneDrive a rendszer a SharePoint-felügyeleti központ használatával, akkor ehhez a Windows PowerShell használatával.

> [!NOTE]
> Üzleti OneDrive beállításával kapcsolatos további tudnivalókért tekintse meg az Office dokumentáció[állítsa be az Office 365 üzleti OneDrive](https://support.office.com/article/Set-up-OneDrive-for-Business-in-Office-365-3e21f8f0-e0a1-43be-aa3e-8c0236bf11bb).

##### A felhasználók konfigurálása
Adjon a felhasználók ezeket az utasításokat, hogy azok OneDrive beállíthatják, üzleti és azok üzleti fájlokat a tartalomvédelmi szolgáltatás védelme.

1.  A OneDrive, kattintson a **Beállítások** ikont, nyissa meg a beállítások menüt, és kattintson a **hely tartalma**.

2.  A fölé a **dokumentumok** mozaik, a beállításokat a hárompontozást jelző (**...**), és kattintson a **BEÁLLÍTÁSOKAT.**

3.  Az a **Beállítások** lapra, és a **engedélyek és a felügyeleti** területen kattintson **tartalomvédelmi**.

4.  Az a **jogok adatkezelési beállításai** lapon válassza **korlátozza tárban engedélyeit** jelölőnégyzetet, adja meg az Ön által választott nevét és az engedélyek leírását, és kattintson a **Beállítások megjelenítése** választható konfigurációk konfigurálása, és kattintson a **OK**.

    A konfigurációs beállításokkal kapcsolatos további tudnivalókért tekintse meg a megjelenő utasításokat [tartalomvédelmi szolgáltatás alkalmazása a lista vagy tár](https://support.office.com/article/Apply-Information-Rights-Management-to-a-list-or-library-3bdb5c4e-94fc-4741-b02f-4e7cc3c54aa1) származó az Office dokumentációjában olvasható.

Ez a konfiguráció a saját üzleti Library OneDrive a tartalomvédelmi szolgáltatás védelme érdekében a rendszergazda helyett a felhasználók alapul, mert tájékoztassa a felhasználókat, ezek a fájlok és a ennek módjáról védelme előnyeiről. Magyarázza el, például, hogy osztoznak OneDrive üzleti dokumentum, ha csak azokat a engedélyezik személyek tudja-e érni az általuk konfigurált, még akkor is, ha a fájl átnevezése, és a másolt máshol korlátozások.

##### A rendszergazdák számára a konfiguráció
Bár a felhasználók OneDrive üzleti tartalomvédelmi szolgáltatás nem tudja konfigurálni a SharePoint-felügyeleti központ használatával, akkor ehhez a Windows PowerShell használatával. Ha engedélyezni szeretné a tartalomvédelmi szolgáltatás ezeket a könyvtárakat, kövesse az alábbi lépéseket:

1.  Töltse le és telepítse a [SharePoint Online Client Components SDK](http://www.microsoft.com/en-us/download/details.aspx?id=42038).

2.  Töltse le és telepítse a [SharePoint Online felügyeleti rendszerhéj](http://www.microsoft.com/en-us/download/details.aspx?id=35588).

3.  Másolja a következő parancsfájl tartalmát, és a számítógépen a Set-IRMOnOneDriveForBusiness.ps1 fájl neve.

    *&#42;&#42;A Jótállás kizárása&#42;&#42;*: A minta parancsprogram alatt bármely Microsoft standard támogatás program vagy a szolgáltatás nem támogatott. A minta parancsprogram formájában kerül, mindenféle garancia nélkül.

    ```
    # Requires Windows PowerShell version 3 <# Description: Configures IRM policy settings for OneDrive for Business and can also be used for SharePoint Online libraries and lists Script Installation Requirements: SharePoint Online Client Components SDK http://www.microsoft.com/en-us/download/details.aspx?id=42038 SharePoint Online Management Shell http://www.microsoft.com/en-us/download/details.aspx?id=35588 ====== #> # URL will be in the format https://<tenant-name>-admin.sharepoint.com $sharepointAdminCenterUrl = "https://contoso-admin.sharepoint.com" $tenantAdmin = "admin@contoso.com" $webUrls = @("https://contoso-my.sharepoint.com/personal/user1_contoso_com", "https://contoso-my.sharepoint.com/personal/user2_contoso_com", "https://contoso-my.sharepoint.com/personal/user3_contoso_com") <# As an alternative to specifying the URLs as an array, you can import them from a CSV file (no header, single value per row). Then, use: $webUrls = Get-Content -Path "File_path_and_name.csv" #> $listTitle = "Documents" function Load-SharePointOnlineClientComponentAssemblies { [cmdletbinding()] param() process { # assembly location: C:\Program Files\Common Files\microsoft shared\Web Server Extensions\16\ISAPI try { Write-Verbose "Loading Assembly: Microsoft.Office.Client.Policy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.Office.Client.Policy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.Office.Client.TranslationServices, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.Office.Client.TranslationServices, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Runtime, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Runtime, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Search.Applications, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Search.Applications, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Search, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Search, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Taxonomy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Taxonomy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.UserProfiles, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.UserProfiles, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null return $true } catch { if($_.Exception.Message -match "Could not load file or assembly") { Write-Error -Message "Unable to load the SharePoint Server 2013 Client Components.`nDownload Location: http://www.microsoft.com/en-us/download/details.aspx?id=42038" } else { Write-Error -Exception $_.Exception } return $false } } } function Load-SharePointOnlineModule { [cmdletbinding()] param() process { do { # Installation location: C:\Program Files\SharePoint Online Management Shell\Microsoft.Online.SharePoint.PowerShell $spoModule = Get-Module -Name Microsoft.Online.SharePoint.PowerShell -ErrorAction SilentlyContinue if(-not $spoModule) { try { Import-Module Microsoft.Online.SharePoint.PowerShell -DisableNameChecking return $true } catch { if($_.Exception.Message -match "Could not load file or assembly") { Write-Error -Message "Unable to load the SharePoint Online Management Shell.`nDownload Location: http://www.microsoft.com/en-us/download/details.aspx?id=35588" } else { Write-Error -Exception $_.Exception } return $false } } else { return $true } } while(-not $spoModule) } } function Set-IrmConfiguration { [cmdletbinding()] param( [parameter(Mandatory=$true)][Microsoft.SharePoint.Client.List]$List, [parameter(Mandatory=$true)][string]$PolicyTitle, [parameter(Mandatory=$true)][string]$PolicyDescription, [parameter(Mandatory=$false)][switch]$IrmReject, [parameter(Mandatory=$false)][DateTime]$ProtectionExpirationDate, [parameter(Mandatory=$false)][switch]$DisableDocumentBrowserView, [parameter(Mandatory=$false)][switch]$AllowPrint, [parameter(Mandatory=$false)][switch]$AllowScript, [parameter(Mandatory=$false)][switch]$AllowWriteCopy, [parameter(Mandatory=$false)][int]$DocumentAccessExpireDays, [parameter(Mandatory=$false)][int]$LicenseCacheExpireDays, [parameter(Mandatory=$false)][string]$GroupName ) process { Write-Verbose "Applying IRM Configuration on '$($List.Title)'" # reset the value to the default settings $list.InformationRightsManagementSettings.Reset() $list.IrmEnabled = $true # IRM Policy title and description $list.InformationRightsManagementSettings.PolicyTitle       = $PolicyTitle $list.InformationRightsManagementSettings.PolicyDescription = $PolicyDescription # Set additional IRM library settings # Do not allow users to upload documents that do not support IRM $list.IrmReject = $IrmReject.IsPresent $parsedDate = Get-Date if([DateTime]::TryParse($ProtectionExpirationDate, [ref]$parsedDate)) { # Stop restricting access to the library at <date> $list.IrmExpire = $true $list.InformationRightsManagementSettings.DocumentLibraryProtectionExpireDate = $ProtectionExpirationDate } # Prevent opening documents in the browser for this Document Library $list.InformationRightsManagementSettings.DisableDocumentBrowserView = $DisableDocumentBrowserView.IsPresent # Configure document access rights # Allow viewers to print $list.InformationRightsManagementSettings.AllowPrint = $AllowPrint.IsPresent # Allow viewers to run script and screen reader to function on downloaded documents $list.InformationRightsManagementSettings.AllowScript = $AllowScript.IsPresent # Allow viewers to write on a copy of the downloaded document $list.InformationRightsManagementSettings.AllowWriteCopy = $AllowWriteCopy.IsPresent if($DocumentAccessExpireDays) { # After download, document access rights will expire after these number of days (1-365) $list.InformationRightsManagementSettings.EnableDocumentAccessExpire = $true $list.InformationRightsManagementSettings.DocumentAccessExpireDays   = $DocumentAccessExpireDays } # Set group protection and credentials interval if($LicenseCacheExpireDays) { # Users must verify their credentials using this interval (days) $list.InformationRightsManagementSettings.EnableLicenseCacheExpire = $true $list.InformationRightsManagementSettings.LicenseCacheExpireDays   = $LicenseCacheExpireDays } if($GroupName) { # Allow group protection. Default group: $list.InformationRightsManagementSettings.EnableGroupProtection = $true $list.InformationRightsManagementSettings.GroupName             = $GroupName } } end { if($list) { Write-Verbose "Committing IRM configuration settings on '$($list.Title)'" $list.InformationRightsManagementSettings.Update() $list.Update() $script:clientContext.Load($list) $script:clientContext.ExecuteQuery() } } } function Get-CredentialFromCredentialCache { [cmdletbinding()] param([string]$CredentialName) #if( Test-Path variable:\global:CredentialCache ) if( Get-Variable O365TenantAdminCredentialCache -Scope Global -ErrorAction SilentlyContinue ) { if($global:O365TenantAdminCredentialCache.ContainsKey($CredentialName)) { Write-Verbose "Credential Cache Hit: $CredentialName" return $global:O365TenantAdminCredentialCache[$CredentialName] } } Write-Verbose "Credential Cache Miss: $CredentialName" return $null } function Add-CredentialToCredentialCache { [cmdletbinding()] param([System.Management.Automation.PSCredential]$Credential) if(-not (Get-Variable CredentialCache -Scope Global -ErrorAction SilentlyContinue)) { Write-Verbose "Initializing the Credential Cache" $global:O365TenantAdminCredentialCache = @{} } Write-Verbose "Adding Credential to the Credential Cache" $global:O365TenantAdminCredentialCache[$Credential.UserName] = $Credential } # load the required assemblies and Windows PowerShell modules if(-not ((Load-SharePointOnlineClientComponentAssemblies) -and (Load-SharePointOnlineModule)) ) { return } # Add the credentials to the client context and SharePoint Online service connection # check for cached credentials to use $o365TenantAdminCredential = Get-CredentialFromCredentialCache -CredentialName $tenantAdmin if(-not $o365TenantAdminCredential) { # when credentials are not cached, prompt for the tenant admin credentials $o365TenantAdminCredential = Get-Credential -UserName $tenantAdmin -Message "Enter the password for the Office 365 admin" if(-not $o365TenantAdminCredential -or -not $o365TenantAdminCredential.UserName -or $o365TenantAdminCredential.Password.Length -eq 0 ) { Write-Error -Message "Could not validate the supplied tenant admin credentials" return } # add the credentials to the cache Add-CredentialToCredentialCache -Credential $o365TenantAdminCredential } # connect to Office365 first, required for SharePoint Online cmdlets to run Connect-SPOService -Url $sharepointAdminCenterUrl -Credential $o365TenantAdminCredential # enumerate each of the specified site URLs foreach($webUrl in $webUrls) { $grantedSiteCollectionAdmin = $false try { # establish the client context and set the credentials to connect to the site $script:clientContext = New-Object Microsoft.SharePoint.Client.ClientContext($webUrl) $script:clientContext.Credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($o365TenantAdminCredential.UserName, $o365TenantAdminCredential.Password) # initialize the site and web context $script:clientContext.Load($script:clientContext.Site) $script:clientContext.Load($script:clientContext.Web) $script:clientContext.ExecuteQuery() # load and ensure the tenant admin user account if present on the target SharePoint site $tenantAdminUser = $script:clientContext.Web.EnsureUser($o365TenantAdminCredential.UserName) $script:clientContext.Load($tenantAdminUser) $script:clientContext.ExecuteQuery() # check if the tenant admin is a site admin if( -not $tenantAdminUser.IsSiteAdmin ) { try { # grant the tenant admin temporary admin rights to the site collection Set-SPOUser -Site $script:clientContext.Site.Url -LoginName $o365TenantAdminCredential.UserName -IsSiteCollectionAdmin $true | Out-Null $grantedSiteCollectionAdmin = $true } catch { Write-Error $_.Exception return } } try { # load the list orlibrary using CSOM $list = $null $list = $script:clientContext.Web.Lists.GetByTitle($listTitle) $script:clientContext.Load($list) $script:clientContext.ExecuteQuery() # **************  ADMIN INSTRUCTIONS  ************** # If necessary, modify the following Set-IrmConfiguration parameters to match your required values # The supplied options and values are for example only # Example that shows the Set-IrmConfiguration command with all parameters: Set-IrmConfiguration -List $list -PolicyTitle "Protected Files" -PolicyDescription "This policy restricts access to authorized users" -IrmReject -ProtectionExpirationDate $(Get-Date).AddDays(180) -DisableDocumentBrowserView -AllowPrint -AllowScript -AllowWriteCopy -LicenseCacheExpireDays 25 -DocumentAccessExpireDays 90 Set-IrmConfiguration -List $list -PolicyTitle "Protected Files" -PolicyDescription "This policy restricts access to authorized users" } catch { Write-Error -Message "Error setting IRM configuration on site: $webUrl.`nError Details: $($_.Exception.ToString())" } } finally { if($grantedSiteCollectionAdmin) { # remove the temporary admin rights to the site collection Set-SPOUser -Site $script:clientContext.Site.Url -LoginName $o365TenantAdminCredential.UserName -IsSiteCollectionAdmin $false | Out-Null } } } Disconnect-SPOService -ErrorAction SilentlyContinue
    ```

4.  Tekintse át a parancsfájlt, és a következő módosításokat:

    1.  Keressen `$sharepointAdminCenterUrl` és példa értékét cserélje le a saját SharePoint felügyeleti központ URL-CÍMÉT.

        Látni fogja ezt az értéket az alap URL-címet, amikor Ön lépjen be a SharePoint-felügyeleti központban, és rendelkezik-e a következő formátumban: https://*&lt; tenant_name &gt;*-admin.sharepoint.com

        Például ha a bérlő neve "contoso", majd meg fog adja meg: **https://contoso-admin.sharepoint.com**

    2.  Keressen `$tenantAdmin` és példa értékét cserélje le a saját teljesen minősített globális rendszergazdafiók az Office 365 szolgáltatáshoz nevű.

        Ez az érték ugyanaz, mint jelentkezzen be az Office 365 rendszergazdai portál a globális rendszergazda segítségével, és rendelkezik a következő formátumban: felhasználónév @*&lt; bérlői tartománynév &gt;*.com

        Például ha az Office 365 globális rendszergazda felhasználónév "rendszergazda" a "contoso.com" bérlői tartomány, akkor fog adja meg: **admin@contoso.com**

    3.  Keressen `$webUrls` és példa értékek helyett adja meg a felhasználók OneDrive üzleti webalkalmazás URL-címek, szükség szerint annyi bejegyzések hozzáadásával vagy törlésével.

        Másik lehetőségként, tekintse meg a Megjegyzések a tömb lecserélni importálásával módjáról a parancsfájl egy. CSV-fájlt, amely tartalmazza az összes az URL-címet kell konfigurálni.  Egy másik minta parancsprogram automatikusan keres, és bontsa ki az URL-címek tölthetők fel a lehetőséget biztosítunk. CSV-fájlt. Amikor ezzel kész, bontsa ki a [Az összes OneDrive kimeneti üzleti URL-címek, hogy további parancsfájl egy. CSV-fájlból](#BKMK_Script_OD4B_URLS) ezeket a lépéseket után azonnal szakaszban.

        A webalkalmazás URL-címe a felhasználó OneDrive üzleti van a következő formátumban: https://*&lt; bérlő neve &gt;*-my.sharepoint.com/personal/*&lt; felhasználónév &gt;*_*&lt; bérlő neve &gt;*_com

        Például ha a felhasználó a contoso bérlő a felhasználónevet a "rsimone", akkor fog adja meg: **https://contoso-my.sharepoint.com/personal/rsimone_contoso_com**

    4.  A parancsfájl konfigurálása az üzleti OneDrive jelenleg használ, mert a nem-e a értékének módosítása **Documents** számára a `$listTitle` változó.

    5.  Keressen `ADMIN INSTRUCTIONS`. Nem végez módosítást, ez a szakasz, ha a felhasználó OneDrive üzleti fogja állítani a tartalomvédelmi szolgáltatás házirend címe "Védett fájl" és "Ez a házirend férhetnek hozzá engedélyezett felhasználók" leírása.  Nincsenek a tartalomvédelmi szolgáltatás beállításai lesz beállítva, amely valószínűleg helyénvaló a legtöbb környezetben. Azonban a javasolt házirend-cím és leírás módosítása, és az egyéb Tartalomvédelmi beállításokat, amelyek a környezetnek megfelelő hozzáadása is. Tekintse meg a parancs példában a parancsfájl segítenek a saját készletének a Set-IrmConfiguration parancs paramétereinek összeállításához.

5.  Mentse a parancsfájlt, és aláírja. Ha nem jelentkezik a parancsfájl (biztonságosabb), a Windows PowerShell aláíratlan parancsfájlok futtatásához a számítógépen kell konfigurálni. Ehhez hajtsa végre a, futtassa a Windows PowerShell munkamenetet a **Futtatás rendszergazdaként** lehetőséget, és írja be: **Set-ExecutionPolicy Unrestricted**. Azonban a konfiguráció lehetővé teszi, hogy az összes aláíratlan parancsfájlok (kevésbé biztonságos).

    Bejelentkezés a Windows PowerShell-parancsfájlok kapcsolatos további információkért tekintse meg a [about_Signing](https://technet.microsoft.com/library/hh847874.aspx) a PowerShell dokumentációs könyvtárában.

6.  A parancsfájl futtatásához, és ha a rendszer kéri, adja meg az Office 365 rendszergazdai fiók jelszavát. Ha a parancsfájl módosítása, és futtassa az ugyanazon a Windows PowerShell munkamenetben, nem bekéri az Ön hitelesítő adatokat.

> [!TIP]
> Ez a parancsfájl segítségével a tartalomvédelmi szolgáltatás konfigurálása a SharePoint Online könyvtár. Ehhez a konfigurációhoz fog valószínűleg engedélyezni szeretné a további beállítás **nem teszik lehetővé, amely nem támogatja a tartalomvédelmi szolgáltatás dokumentumok feltöltésének**, annak érdekében, hogy a könyvtár tartalmaz-e a csak a védett dokumentumok.    Adja hozzá ehhez a `-IrmReject` paraméter a parancsfájl a Set-IrmConfiguration parancs.
> 
> Is módosítani kell a `$webUrls` változó (például **https://contoso.sharepoint.com**) és  `$listTitle` változó (például **$Reports**).

Ha letiltja a tartalomvédelmi szolgáltatás a felhasználó OneDrive az üzleti könyvtárak van szüksége, bontsa ki a [Letiltja a tartalomvédelmi szolgáltatás az üzleti OneDrive parancsfájl](#BKMK_Script_OD4B_DisableIRM) szakaszban.

###### <a name="BKMK_Script_OD4B_URLS"></a>Az összes OneDrive kimeneti üzleti URL-címek, hogy további parancsfájl egy. CSV-fájlból
A fenti 4c lépésben a következő Windows PowerShell-parancsfájl segítségével az URL-címek kiolvasni az üzleti könyvtárak, majd ellenőrizze, szükség esetén módosítsa, és a fő parancsfájl majd importálja az összes felhasználó OneDrive.

Ez a parancsfájl működéséhez a [SharePoint Online Client Components SDK](http://www.microsoft.com/en-us/download/details.aspx?id=42038) és a [SharePoint Online felügyeleti rendszerhéj](http://www.microsoft.com/en-us/download/details.aspx?id=35588). Ugyanezeket a lépéseket, másolja és illessze be, mentse a fájlt helyileg (például "jelentés-OneDriveForBusinessSiteInfo.ps1"), módosítsa a   `$sharepointAdminCenterUrl` és `$tenantAdmin` előtt értékeinek, majd futtassa a parancsfájl.

*&#42;&#42;A Jótállás kizárása&#42;&#42;*: A minta parancsprogram alatt bármely Microsoft standard támogatás program vagy a szolgáltatás nem támogatott. A minta parancsprogram formájában kerül, mindenféle garancia nélkül.

```
# Requires Windows PowerShell version 3 <# Description: Queries the search service of an Office 365 tenant to retrieve all OneDrive for Business sites. Details of the discovered sites are written to a .CSV file (by default,"OneDriveForBusinessSiteInfo_<date>.csv"). Script Installation Requirements: SharePoint Online Client Components SDK http://www.microsoft.com/en-us/download/details.aspx?id=42038 SharePoint Online Management Shell http://www.microsoft.com/en-us/download/details.aspx?id=35588 ====== #> # URL will be in the format https://<tenant-name>-admin.sharepoint.com $sharepointAdminCenterUrl = "https://contoso-admin.sharepoint.com" $tenantAdmin = "admin@contoso.onmicrosoft.com" $reportName = "OneDriveForBusinessSiteInfo_$((Get-Date).ToString("yyyy-MM-dd_hh.mm.ss")).csv" $oneDriveForBusinessSiteUrls= @() $resultsProcessed = 0 function Load-SharePointOnlineClientComponentAssemblies { [cmdletbinding()] param() process { # assembly location: C:\Program Files\Common Files\microsoft shared\Web Server Extensions\16\ISAPI try { Write-Verbose "Loading Assembly: Microsoft.Office.Client.Policy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.Office.Client.Policy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.Office.Client.TranslationServices, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.Office.Client.TranslationServices, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Runtime, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Runtime, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Search.Applications, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Search.Applications, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Search, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Search, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Taxonomy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Taxonomy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.UserProfiles, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.UserProfiles, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null return $true } catch { if($_.Exception.Message -match "Could not load file or assembly") { Write-Error -Message "Unable to load the SharePoint Server 2013 Client Components.`nDownload Location: http://www.microsoft.com/en-us/download/details.aspx?id=42038" } else { Write-Error -Exception $_.Exception } return $false } } } function Load-SharePointOnlineModule { [cmdletbinding()] param() process { do { # Installation location: C:\Program Files\SharePoint Online Management Shell\Microsoft.Online.SharePoint.PowerShell $spoModule = Get-Module -Name Microsoft.Online.SharePoint.PowerShell -ErrorAction SilentlyContinue if(-not $spoModule) { try { Import-Module Microsoft.Online.SharePoint.PowerShell -DisableNameChecking return $true } catch { if($_.Exception.Message -match "Could not load file or assembly") { Write-Error -Message "Unable to load the SharePoint Online Management Shell.`nDownload Location: http://www.microsoft.com/en-us/download/details.aspx?id=35588" } else { Write-Error -Exception $_.Exception } return $false } } else { return $true } } while(-not $spoModule) } } function Get-CredentialFromCredentialCache { [cmdletbinding()] param([string]$CredentialName) #if( Test-Path variable:\global:CredentialCache ) if( Get-Variable O365TenantAdminCredentialCache -Scope Global -ErrorAction SilentlyContinue ) { if($global:O365TenantAdminCredentialCache.ContainsKey($CredentialName)) { Write-Verbose "Credential Cache Hit: $CredentialName" return $global:O365TenantAdminCredentialCache[$CredentialName] } } Write-Verbose "Credential Cache Miss: $CredentialName" return $null } function Add-CredentialToCredentialCache { [cmdletbinding()] param([System.Management.Automation.PSCredential]$Credential) if(-not (Get-Variable CredentialCache -Scope Global -ErrorAction SilentlyContinue)) { Write-Verbose "Initializing the Credential Cache" $global:O365TenantAdminCredentialCache = @{} } Write-Verbose "Adding Credential to the Credential Cache" $global:O365TenantAdminCredentialCache[$Credential.UserName] = $Credential } # load the required assemblies and Windows PowerShell modules if(-not ((Load-SharePointOnlineClientComponentAssemblies) -and (Load-SharePointOnlineModule)) ) { return } # Add the credentials to the client context and SharePoint Online service connection # check for cached credentials to use $o365TenantAdminCredential = Get-CredentialFromCredentialCache -CredentialName $tenantAdmin if(-not $o365TenantAdminCredential) { # when credentials are not cached, prompt for the tenant admin credentials $o365TenantAdminCredential = Get-Credential -UserName $tenantAdmin -Message "Enter the password for the Office 365 admin" if(-not $o365TenantAdminCredential -or -not $o365TenantAdminCredential.UserName -or $o365TenantAdminCredential.Password.Length -eq 0 ) { Write-Error -Message "Could not validate the supplied tenant admin credentials" return } # add the credentials to the cache Add-CredentialToCredentialCache -Credential $o365TenantAdminCredential } # establish the client context and set the credentials to connect to the site $clientContext = New-Object Microsoft.SharePoint.Client.ClientContext($sharepointAdminCenterUrl) $clientContext.Credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($o365TenantAdminCredential.UserName, $o365TenantAdminCredential.Password) # run a query against the Office 365 tenant search service to retrieve all OneDrive for Business URLs do { # build the query object $query = New-Object Microsoft.SharePoint.Client.Search.Query.KeywordQuery($clientContext) $query.TrimDuplicates        = $false $query.RowLimit              = 500 $query.QueryText             = "SPSiteUrl:'/personal/' AND contentclass:STS_Site" $query.StartRow              = $resultsProcessed $query.TotalRowsExactMinimum = 500000 # run the query $searchExecutor = New-Object Microsoft.SharePoint.Client.Search.Query.SearchExecutor($clientContext) $queryResults = $searchExecutor.ExecuteQuery($query) $clientContext.ExecuteQuery() # enumerate the search results and store the site URLs $queryResults.Value[0].ResultRows | % { $oneDriveForBusinessSiteUrls += $_.Path $resultsProcessed++ } } while($resultsProcessed -lt $queryResults.Value.TotalRows) $oneDriveForBusinessSiteUrls | Out-File -FilePath $reportName
```

###### <a name="BKMK_Script_OD4B_DisableIRM"></a>Letiltja a tartalomvédelmi szolgáltatás az üzleti OneDrive parancsfájl
Ha letiltja a tartalomvédelmi szolgáltatás a felhasználók OneDrive üzleti kell, használja a következő minta parancsprogram.

Ez a parancsfájl működéséhez a [SharePoint Online Client Components SDK](http://www.microsoft.com/en-us/download/details.aspx?id=42038) és a [SharePoint Online felügyeleti rendszerhéj](http://www.microsoft.com/en-us/download/details.aspx?id=35588). Másolása és beillesztése, mentse a fájlt helyileg (például "Disable-IRMOnOneDriveForBusiness.ps1") és a módosítása a   `$sharepointAdminCenterUrl` és `$tenantAdmin` értékeket. Manuálisan adja meg a OneDrive, üzleti URL-címek, vagy használja a parancsfájl az előző szakasz, hogy importálja ezeket, és futtassa újra a parancsfájl.

*&#42;&#42;A Jótállás kizárása&#42;&#42;*: A minta parancsprogram alatt bármely Microsoft standard támogatás program vagy a szolgáltatás nem támogatott. A minta parancsprogram formájában kerül, mindenféle garancia nélkül.

```
# Requires Windows PowerShell version 3 <# Description: Disables IRM for OneDrive for Business and can also be used for SharePoint Online libraries and lists Script Installation Requirements: SharePoint Online Client Components SDK http://www.microsoft.com/en-us/download/details.aspx?id=42038 SharePoint Online Management Shell http://www.microsoft.com/en-us/download/details.aspx?id=35588 ====== #> $sharepointAdminCenterUrl = "https://contoso-admin.sharepoint.com" $tenantAdmin = "admin@contoso.com" $webUrls = @("https://contoso-my.sharepoint.com/personal/user1_contoso_com", "https://contoso-my.sharepoint.com/personal/user2_contoso_com", "https://contoso-my.sharepoint.com/personal/person3_contoso_com") <# As an alternative to specifying the URLs as an array, you can import them from a CSV file (no header, single value per row). Then, use: $webUrls = Get-Content -Path "File_path_and_name.csv" #> $listTitle = "Documents" function Load-SharePointOnlineClientComponentAssemblies { [cmdletbinding()] param() process { # assembly location: C:\Program Files\Common Files\microsoft shared\Web Server Extensions\16\ISAPI try { Write-Verbose "Loading Assembly: Microsoft.Office.Client.Policy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.Office.Client.Policy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.Office.Client.TranslationServices, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.Office.Client.TranslationServices, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Publishing, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Runtime, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Runtime, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Search.Applications, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Search.Applications, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Search, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Search, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.Taxonomy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.Taxonomy, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null Write-Verbose "Loading Assembly: Microsoft.SharePoint.Client.UserProfiles, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" [System.Reflection.Assembly]::Load("Microsoft.SharePoint.Client.UserProfiles, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c") | Out-Null return $true } catch { if($_.Exception.Message -match "Could not load file or assembly") { Write-Error -Message "Unable to load the SharePoint Server 2013 Client Components.`nDownload Location: http://www.microsoft.com/en-us/download/details.aspx?id=42038" } else { Write-Error -Exception $_.Exception } return $false } } } function Load-SharePointOnlineModule { [cmdletbinding()] param() process { do { # Installation location: C:\Program Files\SharePoint Online Management Shell\Microsoft.Online.SharePoint.PowerShell $spoModule = Get-Module -Name Microsoft.Online.SharePoint.PowerShell -ErrorAction SilentlyContinue if(-not $spoModule) { try { Import-Module Microsoft.Online.SharePoint.PowerShell -DisableNameChecking return $true } catch { if($_.Exception.Message -match "Could not load file or assembly") { Write-Error -Message "Unable to load the SharePoint Online Management Shell.`nDownload Location: http://www.microsoft.com/en-us/download/details.aspx?id=35588" } else { Write-Error -Exception $_.Exception } return $false } } else { return $true } } while(-not $spoModule) } } function Remove-IrmConfiguration { [cmdletbinding()] param( [parameter(Mandatory=$true)][Microsoft.SharePoint.Client.List]$List ) process { Write-Verbose "Disabling IRM Configuration on '$($List.Title)'" $List.IrmEnabled = $false $List.IrmExpire  = $false $List.IrmReject  = $false $List.InformationRightsManagementSettings.Reset() } end { if($List) { Write-Verbose "Committing IRM configuration settings on '$($list.Title)'" $list.InformationRightsManagementSettings.Update() $list.Update() $script:clientContext.Load($list) $script:clientContext.ExecuteQuery() } } } function Get-CredentialFromCredentialCache { [cmdletbinding()] param([string]$CredentialName) #if( Test-Path variable:\global:CredentialCache ) if( Get-Variable O365TenantAdminCredentialCache -Scope Global -ErrorAction SilentlyContinue ) { if($global:O365TenantAdminCredentialCache.ContainsKey($CredentialName)) { Write-Verbose "Credential Cache Hit: $CredentialName" return $global:O365TenantAdminCredentialCache[$CredentialName] } } Write-Verbose "Credential Cache Miss: $CredentialName" return $null } function Add-CredentialToCredentialCache { [cmdletbinding()] param([System.Management.Automation.PSCredential]$Credential) if(-not (Get-Variable CredentialCache -Scope Global -ErrorAction SilentlyContinue)) { Write-Verbose "Initializing the Credential Cache" $global:O365TenantAdminCredentialCache = @{} } Write-Verbose "Adding Credential to the Credential Cache" $global:O365TenantAdminCredentialCache[$Credential.UserName] = $Credential } # load the required assemblies and Windows PowerShell modules if(-not ((Load-SharePointOnlineClientComponentAssemblies) -and (Load-SharePointOnlineModule)) ) { return } # Add the credentials to the client context and SharePoint Online service connection # check for cached credentials to use $o365TenantAdminCredential = Get-CredentialFromCredentialCache -CredentialName $tenantAdmin if(-not $o365TenantAdminCredential) { # when credentials are not cached, prompt for the tenant admin credentials $o365TenantAdminCredential = Get-Credential -UserName $tenantAdmin -Message "Enter the password for the Office 365 admin" if(-not $o365TenantAdminCredential -or -not $o365TenantAdminCredential.UserName -or $o365TenantAdminCredential.Password.Length -eq 0 ) { Write-Error -Message "Could not validate the supplied tenant admin credentials" return } # add the credentials to the cache Add-CredentialToCredentialCache -Credential $o365TenantAdminCredential } # connect to Office365 first, required for SharePoint Online cmdlets to run Connect-SPOService -Url $sharepointAdminCenterUrl -Credential $o365TenantAdminCredential # enumerate each of the specified site URLs foreach($webUrl in $webUrls) { $grantedSiteCollectionAdmin = $false try { # establish the client context and set the credentials to connect to the site $script:clientContext = New-Object Microsoft.SharePoint.Client.ClientContext($webUrl) $script:clientContext.Credentials = New-Object Microsoft.SharePoint.Client.SharePointOnlineCredentials($o365TenantAdminCredential.UserName, $o365TenantAdminCredential.Password) # initialize the site and web context $script:clientContext.Load($script:clientContext.Site) $script:clientContext.Load($script:clientContext.Web) $script:clientContext.ExecuteQuery() # load and ensure the tenant admin user account if present on the target SharePoint site $tenantAdminUser = $script:clientContext.Web.EnsureUser($o365TenantAdminCredential.UserName) $script:clientContext.Load($tenantAdminUser) $script:clientContext.ExecuteQuery() # check if the tenant admin is a site admin if( -not $tenantAdminUser.IsSiteAdmin ) { try { # grant the tenant admin temporary admin rights to the site collection Set-SPOUser -Site $script:clientContext.Site.Url -LoginName $o365TenantAdminCredential.UserName -IsSiteCollectionAdmin $true | Out-Null $grantedSiteCollectionAdmin = $true } catch { Write-Error $_.Exception return } } try { # load the list orlibrary using CSOM $list = $null $list = $script:clientContext.Web.Lists.GetByTitle($listTitle) $script:clientContext.Load($list) $script:clientContext.ExecuteQuery() Remove-IrmConfiguration -List $list } catch { Write-Error -Message "Error setting IRM configuration on site: $webUrl.`nError Details: $($_.Exception.ToString())" } } finally { if($grantedSiteCollectionAdmin) { # remove the temporary admin rights to the site collection Set-SPOUser -Site $script:clientContext.Site.Url -LoginName $o365TenantAdminCredential.UserName -IsSiteCollectionAdmin $false | Out-Null } } } Disconnect-SPOService -ErrorAction SilentlyContinue
```

## <a name="BKMK_Office2013Configuration"></a>Office 2016 és az Office 2013: Ügyfelek konfigurálása
Ilyen újabb verziójú Office natív módon támogatja az Azure RMS, mert nincs ügyfélszámítógép konfigurálása nem szükséges az alkalmazások, például a Word, Excel, PowerPoint, az Outlook és az Outlook Web App támogatására a tartalomvédelmi (szolgáltatás IRM) szolgáltatásokat. Minden felhasználó nem rendelkezik, jelentkezzen be az Office-alkalmazásokhoz, azok [!INCLUDE[o365_1](../Token/o365_1_md.md)] hitelesítő adatokat, és is védheti a fájlokat, és az e-maileket, és használni a fájlok és a mások által védett e-maileket..

Azonban azt javasoljuk, hogy ezek az alkalmazások kiegészítik-e a Rights Management szolgáltatással megosztó alkalmazásban, hogy a felhasználók élvezheti a az Office bővítmény. További tudnivalókért tekintse meg a [A Rights Management megosztóalkalmazás: Telepítés és az ügyfelek konfigurálása](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_SharingApp) szakaszban, a jelen témakörben található.

## <a name="BKMK_Office2010Configuration"></a>Az Office 2010: Ügyfelek konfigurálása
Az ügyfélszámítógépek részére Azure RMS használatához az Office 2010 azok telepítve kell lennie a Windows Rights Management megosztóalkalmazás. Nincs további beállítás nem szükséges, eltérő felhasználók kell jelentkeznie a saját [!INCLUDE[o365_1](../Token/o365_1_md.md)] hitelesítő adatokat, és fájlok védelmét, majd használni, amelyet mások által védett fájlokat.

A Rights Management megosztóalkalmazás kapcsolatos további információkért tekintse meg a [A Rights Management megosztóalkalmazás: Telepítés és az ügyfelek konfigurálása](../Topic/Configuring_Applications_for_Azure_Rights_Management.md#BKMK_SharingApp) szakaszban, a jelen témakörben található.

## <a name="BKMK_SharingApp"></a>A Rights Management megosztóalkalmazás: Telepítés és az ügyfelek konfigurálása
A Rights Management (RMS) megosztóalkalmazás az ügyfélszámítógépek részére Azure RMS használatához az Office 2010 szükséges, és az összes számítógép és a mobil eszközök, amely támogatja az Azure RMS ajánlott. Az RMS-megosztó alkalmazás integrálódik, az Office alkalmazások telepítésével az Office-bővítmény, hogy a felhasználók könnyen védhető fájlok és az e-maileket közvetlenül a menüszalagon látható. Is kínál az Azure RMS, és a dokumentum nyomon követése a webhely felhasználói nyomon követésére és azok védelme fájlok visszavonni natív módon nem támogatott típusú fájlokat általános védelmét.

### <a name="BKMK_SharingAppforWindows"></a>Az RMS-megosztó a Windows alkalmazás: Telepítés és a konfiguráció
A telepítés konfigurálása az RMS-megosztó alkalmazás egy vállalati központi Windows tekintse meg a [a Rights Management megosztási alkalmazás rendszergazdai útmutatójában](http://technet.microsoft.com/library/dn339003.aspx).

> [!TIP]
> Ha azt szeretné, hogy gyorsan telepítheti és tesztelheti az RMS-megosztó alkalmazás egyetlen számítógép, tekintse meg a [Töltse le és telepítse a Rights Management megosztóalkalmazás](http://technet.microsoft.com/library/dn574734.aspx) származó a [a Rights Management megosztási alkalmazás felhasználói útmutató](http://technet.microsoft.com/library/dn339006.aspx).

### <a name="BKMK_SharingAppMovileDevices"></a>Az RMS-megosztó a mobil platformokon alkalmazás: A telepítés
Az RMS-megosztó alkalmazás mobil platformokhoz telepítéséhez letöltheti a megfelelő alkalmazást a hivatkozásokra a [a Microsoft Rights Management lap](http://go.microsoft.com/fwlink/?LinkId=303970). Nincs szükség konfigurációra Azure RMS használata az alkalmazás.

## <a name="BKMK_RMSAPIs"></a>Más alkalmazások, amely támogatja az RMS API-k: Telepítés és a konfiguráció
A kategória magában foglalja a sor üzleti alkalmazások, amelyek az RMS SDK használatával házon belül vannak megírva, és az RMS SDK segítségével írt szoftver szállítói az alkalmazásokat. Ezeket az alkalmazásokat kövesse az utasításokat az alkalmazás által biztosított.

## További lépések
Az alkalmazások Azure Rights Management támogatásához konfigurálása után használja a [Azure Rights Management – üzembehelyezési menetrend](../Topic/Azure_Rights_Management_Deployment_Roadmap.md) ellenőrizze, hogy vannak-e más konfigurációs lépések előtt meg összegző lehet, hogy kívánt [!INCLUDE[aad_rightsmanagement_1](../Token/aad_rightsmanagement_1_md.md)] a felhasználók és a rendszergazdák. Ha nem, tekintse meg a [Azure Rights Management használata](../Topic/Using_Azure_Rights_Management.md) a következő lépéseket.

## Lásd még
[Azure Rights Management konfigurálása](../Topic/Configuring_Azure_Rights_Management.md)

